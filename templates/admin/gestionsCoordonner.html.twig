{% extends 'base.html.twig' %}

{% block title %}
	Gestions des Coordonnées | Electro-Multifix
{% endblock %}

{% block body %}

	{% include 'admin/_menu.html.twig' %}


	<div class="my-3 text-center">
		<h2>Gestion des Coordonnées</h2>
	</div>


	<div
		class="container mt-5">

		<!-- Formulaire d'ajout ou de modification -->
		<div class="card mb-4 border border-dark">
			<div class="card-header bg-primary text-white">
				<h4>Enregistrer un Coordonnée</h4>
			</div>
			<div class="card-body">
				{{ form_start(form) }}

				<div class="row">
					<div class="col-md-6 mb-3">
						{{ form_label(form.email, 'Email', {'label_attr': {'class': 'form-label'}}) }}
						{{ form_widget(form.email, {'attr': {'class': 'form-control border border-dark'}}) }}
					</div>
					<div class="col-md-6 mb-3">
						{{ form_label(form.phone, 'Téléphone', {'label_attr': {'class': 'form-label'}}) }}
						{{ form_widget(form.phone, {'attr': {'class': 'form-control border border-dark'}}) }}
					</div>
				</div>

				<div class="text-center">
					<button type="submit" class="btn btn-success form-control border border-dark">Enregistrer</button>
				</div>

				{{ form_end(form) }}
			</div>
		</div>

		<!-- Liste des coordonnées -->
		<div class="card">
			<div class="card-header bg-secondary text-white">
				<h4>Liste des Coordonnées</h4>
			</div>

			{% for type, messages in app.flashes %}
				{% for message in messages %}
					<div class="alert alert-{{ type }} alert-dismissible fade show" role="alert">
						{{ message }}
						<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
					</div>
				{% endfor %}
			{% endfor %}


			<div class="card-body table-responsive">
				{% if coordonnees is empty %}
					<p class="text-center alert alert-info">Aucune coordonnée disponible.</p>
				{% else %}
					<table class="table table-bordered table-striped">
						<thead>
							<tr>
								<th>#</th>
								<th>Email</th>
								<th>Téléphone</th>
								<th>Status</th>
								<th>Actions</th>
							</tr>
						</thead>
						<tbody>
							{% for coordonner in coordonnees %}
								<tr>
									<td class="text-center align-items-center">{{ coordonner.id }}</td>
									<td class="text-center align-items-center">{{ coordonner.email }}</td>
									<td class="text-center align-items-center">{{ coordonner.phone }}</td>
									<td class="text-center align-items-center">
										<label class="form-switch">
											<input type="checkbox" role="switch" {{(coordonner.status) ? 'checked' : ''}} data-id="{{coordonner.id}}">
										</label>
									</td>
									<td class="text-center align-items-center">
										<a href="{{ path('admin_coordonner_modif', {id: coordonner.id}) }}" class="btn btn-warning btn-sm">Modifier</a>
										<form action="{{ path('admin_coordonner_supp', {'id': coordonner.id}) }}" method="post" onsubmit="return confirm('Confirmer la suppression du coordonnée ?');" class="d-inline">
											<input type="hidden" name="_token" value="{{ csrf_token('SUP' ~ coordonner.id) }}">
											<button type="submit" class="btn btn-danger">
												<i class="fa-regular fa-trash-can"></i>
											</button>
										</form>
									</td>
								</tr>

							{% endfor %}
						</tbody>
					</table>
				{% endif %}

				<!-- Pagination -->
				<div class="d-flex justify-content-center">
					{{ knp_pagination_render(coordonnees) }}
				</div>
			</div>
		</div>
	</div>


	<script>
		window.onload = () => {
let activer = document.querySelectorAll("[type=checkbox]")
for (let bouton of activer) {
bouton.addEventListener("click", function () {
let xmlhttp = new XMLHttpRequest;
xmlhttp.open("get", `/admin/coordonner/activer/${
this.dataset.id
}`)
xmlhttp.send()
})
}
}
	</script>
{% endblock %}
