{% extends 'base.html.twig' %}

{% block title %}
	Détails du service | Electro-Multifix
{% endblock %}

{% block body %}
	{% include 'admin/_menu.html.twig' %}

	<div class="container mt-5">
		<h1 class="text-center">Détails du service</h1>
		<div
			class="row">
			<!-- Image du service -->
			<div class="col-md-6 mt-2">
				<div class="card shadow-sm">
					{% if service.image %}
						<img src="{{ asset('assets/images/services/' ~ service.image) }}" alt="{{ service.titre }}" class="card-img-top rounded">
					{% else %}
						<p class="text-danger">Aucune image trouver</p>
					{% endif %}
				</div>
			</div>

			<!-- Détails du service -->
			<div class="col-md-6 mt-2">
				<div class="card p-3">
					<h2 class="card-title">{{ service.titre }}</h2>
					<div class="card-body">
						<p class="card-text">
							<strong>Prix moyen du service:</strong>
							{{ service.prix }}
							DJF
						</p>

						<p class="card-text">
							<strong>Date de création du service:</strong>
							{{ service.date|date('d/m/Y') }}
						</p>


						<p class="card-text">
							<strong>Status du service:</strong>
							{% if service.status %}
								<span class="badge bg-success">Activer</span>
							{% else %}
								<span class="badge bg-danger">Désactiver</span>
							{% endif %}

						</p>

						<p class="card-text">
							<strong>Description du service :</strong>
							{{ service.description }}</p>


					</div>
				</div>
			</div>
		</div>

		<!-- Section réparations associées -->
		<div
			class="mt-5">
			<!-- Section statistiques -->
			<div class="mt-4">
				<div class="row">
					<div class="col-md-4">
						<div class="card shadow-sm text-center alert alert-danger border border-dark">
							<div class="card-body">
								<h5 class="card-title">Réparations Total</h5>
								<p class="card-text fs-2 text-warning">{{ statistiques.total }}</p>
							</div>
						</div>
					</div>
					<div class="col-md-4">
						<div class="card shadow-sm text-center alert alert-warning border border-dark">
							<div class="card-body">
								<h5 class="card-title">Réparations en cours</h5>
								<p class="card-text fs-2 text-warning">{{ statistiques.en_cours }}</p>
							</div>
						</div>
					</div>
					<div class="col-md-4">
						<div class="card shadow-sm text-center alert alert-success border border-dark">
							<div class="card-body">
								<h5 class="card-title">Réparations terminées</h5>
								<p class="card-text fs-2 text-success">{{ statistiques.termines }}</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<h3 class="mb-4">Réparations associées à ce service</h3>

			{% if reparations is not empty %}
				<div class="table-responsive">
					<table class="table">
						<thead class="table-info">
							<tr>
								<th>#</th>
								<th>Image</th>
								<th>Statut</th>
								<th>Date deposer</th>
								<th>Date de reprise</th>
								<th>Action</th>
							</tr>
						</thead>
						<tbody>
							{% for reparation in reparations %}
								<tr>
									<td>{{ loop.index }}</td>
									<td>
										{% if reparation.image %}
											<img src="{{ asset('assets/images/reparations/' ~ reparation.image) }}" alt="Image de la réparation" style="width: 100px;" class="rounded">
										{% else %}
											Pas d'image
										{% endif %}
									</td>
									<td>
										{% if reparation.status %}
											<span class="badge bg-success">Terminé</span>
										{% else %}
											<span class="badge bg-warning">En cours</span>
										{% endif %}
									</td>
									<td>{{ reparation.createdAt|date('d/m/Y') }}</td>
									<td>{{ reparation.dateRepri|date('d/m/Y') }}</td>
									<td>
										<a href="{{path('admin_voir_reparation',{'matricule':reparation.matricule,'id':reparation.id})}}" class="btn btn-info">
											<i class="fa-solid fa-eye"></i>
										</a>
									</td>
								</tr>
							{% endfor %}
						</tbody>
					</table>

					<div class="navigation">
						{{ knp_pagination_render(reparations) }}
					</div>
				</div>
			{% else %}
				<div class="alert alert-warning">
					Aucune réparation associée à ce service.
				</div>
			{% endif %}
		</div>


	</div>
{% endblock %}
